# 🚀 자동 배포 가이드

## 방법 1: 자동 배포 스크립트 사용 (가장 쉬움!)

### 1단계: 스크립트 실행
```bash
./auto-deploy.sh
```

이 스크립트가 자동으로:
- ✅ 환경 변수 파일 생성
- ✅ 의존성 설치
- ✅ 프로젝트 빌드
- ✅ Git 저장소 초기화
- ✅ GitHub 푸시 준비

### 2단계: Google Sheets 설정
`GOOGLE_SHEETS_SETUP.md` 파일을 참고하여 Google Sheets를 설정하고 `.env` 파일을 업데이트하세요.

### 3단계: Railway 배포
스크립트가 안내하는 대로 Railway에서 배포하세요.

---

## 방법 2: Railway CLI 사용 (빠른 배포)

### 1단계: Railway CLI 설치 및 로그인
```bash
npm install -g @railway/cli
railway login
```

### 2단계: 빠른 배포
```bash
./quick-deploy.sh
```

또는 수동으로:
```bash
railway init
railway up
```

### 3단계: 환경 변수 설정
Railway 대시보드에서 또는 CLI로:
```bash
railway variables set NODE_ENV=production
railway variables set PORT=5001
railway variables set HOST=0.0.0.0
railway variables set JWT_SECRET=$(openssl rand -hex 32)
railway variables set GOOGLE_SHEETS_ID=<your_sheet_id>
railway variables set GOOGLE_SERVICE_ACCOUNT='<your_json>'
```

---

## 방법 3: Railway 웹 대시보드 사용

### 1단계: GitHub에 푸시
```bash
git add .
git commit -m "Deploy to Railway"
git push origin main
```

### 2단계: Railway에서 배포
1. https://railway.app 접속
2. "New Project" 클릭
3. "Deploy from GitHub repo" 선택
4. 저장소 선택
5. 환경 변수 설정 (아래 참고)
6. 자동 배포 완료!

---

## 환경 변수 설정 (Railway)

Railway 대시보드 → Settings → Variables에서 다음 변수들을 추가:

### 필수 변수
```
NODE_ENV=production
PORT=5001
HOST=0.0.0.0
JWT_SECRET=<openssl rand -hex 32로 생성>
GOOGLE_SHEETS_ID=<스프레드시트 ID>
GOOGLE_SERVICE_ACCOUNT=<서비스 계정 JSON 전체>
```

### JWT_SECRET 생성
```bash
openssl rand -hex 32
```

### GOOGLE_SERVICE_ACCOUNT 설정
- 서비스 계정 JSON 파일의 전체 내용을 복사
- 따옴표 안에 넣어서 설정
- 예: `{"type":"service_account","project_id":"..."}`

---

## 배포 후 확인

### 1. 도메인 확인
Railway 대시보드 → Settings → Domains에서 URL 확인

### 2. 접속 테스트
- 키오스크: `https://your-app.railway.app/kiosk`
- 관리자: `https://your-app.railway.app/admin`
- 공용 대시보드: `https://your-app.railway.app/public`

### 3. 관리자 로그인
- 아이디: `admin`
- 비밀번호: `admin1234`

⚠️ **프로덕션 환경에서는 반드시 비밀번호를 변경하세요!**

---

## 커스텀 도메인 설정

### 1. Railway에서 도메인 추가
1. Settings → Domains
2. "Custom Domain" 클릭
3. 도메인 입력

### 2. DNS 설정
Railway가 제공하는 DNS 레코드를 도메인에 추가:
- CNAME 레코드 추가
- 또는 A 레코드 추가

---

## 문제 해결

### 빌드 실패
- Node.js 버전 확인 (v16 이상)
- Railway 로그 확인
- 환경 변수 확인

### 런타임 오류
- Google Sheets 권한 확인
- 환경 변수 형식 확인
- 서버 로그 확인

### 접속 불가
- HTTPS URL 사용 확인
- 경로 확인 (`/kiosk`, `/admin`, `/public`)
- Railway 서비스 상태 확인

---

## 자동 재배포

GitHub에 푸시하면 Railway가 자동으로 재배포합니다!

```bash
git add .
git commit -m "Update"
git push origin main
```

---

## 비용

Railway는 무료 플랜을 제공합니다:
- $5 크레딧/월 (무료)
- 소규모 프로젝트에 충분

더 많은 트래픽이 필요하면 유료 플랜으로 업그레이드하세요.

---

## 보안 체크리스트

배포 전 확인:
- [ ] 강력한 JWT_SECRET 사용
- [ ] 관리자 비밀번호 변경
- [ ] 환경 변수 보호
- [ ] HTTPS 사용
- [ ] Google Sheets 권한 확인

---

## 완료! 🎉

이제 어디서나 인터넷만 있으면 접근 가능합니다!

- ✅ 아이패드
- ✅ 아이폰
- ✅ 안드로이드
- ✅ 노트북
- ✅ 데스크톱
